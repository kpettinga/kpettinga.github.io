function document_ready(e){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},writable:!0,configurable:!0}),function(e){function t(){return this.last?this.name:this.name+"<br/>"}var n=[{id:"hello",headline:"<small>See the goods</small>",template:"intro"},{id:"hester-street",headline:"Hester Street Collaborative",text:"Hester Street is an urban planning, design and development nonprofit based in the Lower East Side of Manhattan. After a rebranding process, we built a website which allows them to showcase their impact on the communities they serve.",url:"http://hesterstreet.org/",urlText:"hesterstreet.org",video:{atts:'loop muted preload="preload"',webm:"assets/video/hester-project-scroll.webm",mp4:"assets/video/hester-project-scroll.mp4",width:"1584",height:"898"},tags:[{name:"Wordpress"},{name:"Mapbox"},{name:"vue.js",last:!0}],tagName:t,role:"Primary Developer",color:"#3266CC",fill:"#3266CC"},{id:"gibney",headline:"Gibney",text:"Gibney, formerly Gibney Dance, is an organization whose mission is to bring the possibility of movement where it otherwise would not exist. Their new site seeks to emphasize the full scope of Gibney, acting as a portal connecting users to the myriads of performances, workshops, and weekly events.",url:"http://gibneydance.org/",urlText:"gibneydance.org",video:{atts:'loop muted preload="preload"',webm:"assets/video/gibney-flow.webm",mp4:"assets/video/gibney-flow.mp4",width:"1422",height:"958"},tags:[{name:"Wordpress"},{name:"Events Calendar"},{name:"slick.js",last:!0}],tagName:t,role:"Primary Developer",color:"#000000",fill:"#111"},{id:"transit-center",headline:"TransitCenter",text:"TransitCenter is a foundation dedicated to urban mobility. They needed a website which would help them communicate with communities and policy makers in urban areas to affect change. We developed a modular system of content with which they can publish online reports about transit use. In addition, the site is also a place to search grant recipients, see upcoming events, and read their blog.",url:"http://transitcenter.org/",urlText:"transitcenter.org",video:{atts:'loop muted preload="preload"',webm:"assets/video/transit-center-flow.webm",mp4:"assets/video/transit-center-flow.mp4",width:"1422",height:"810"},tags:[{name:"Wordpress"},{name:"AJAX"},{name:"Modular Content",last:!0}],tagName:t,role:"Primary Developer",color:"#5E28B2",fill:"#5E28B2"},{id:"orpheus",headline:"Orpheus Chamber Orchestra",text:"Pellentesque in ipsum id orci porta dapibus. Nulla quis lorem ut libero malesuada feugiat. Donec sollicitudin molestie malesuada.",url:"http://orpheusnyc.org/",urlText:"orpheusnyc.org",video:{atts:'loop muted preload="preload"',webm:"assets/video/orpheus-flow-1.webm",mp4:"assets/video/orpheus-flow-1.mp4",width:"1678",height:"942"},tags:[],tagName:t,role:"Primary Developer",color:"#C48014",fill:"#C48014"},{id:"cgu",headline:"Claremont Graduate University",text:"Pellentesque in ipsum id orci porta dapibus. Nulla quis lorem ut libero malesuada feugiat. Donec sollicitudin molestie malesuada.",url:"http://cgu.edu/",urlText:"cgu.edu",video:{atts:'loop muted preload="preload"',webm:"assets/video/cgu-flow.webm",mp4:"assets/video/cgu-flow.mp4",width:"1424",height:"956"},tags:[],tagName:t,role:"Lead Front-End Developer",color:"#AF1E27",fill:"#AF1E27"},{id:"lets-chat",headline:"Let's Chat",template:"outro"}];e.APP_FRAMES=n}(this),function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e.Mustache={},t(e.Mustache))}(this,function(E){var t=Object.prototype.toString,k=Array.isArray||function(e){return"[object Array]"===t.call(e)};function c(e){return"function"==typeof e}function T(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(e,t){return null!=e&&"object"==typeof e&&t in e}var r=RegExp.prototype.test;var i=/\S/;function x(e){return t=i,n=e,!r.call(t,n);var t,n}var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var L=/\s*/,C=/\s+/,A=/\s*=/,j=/\s*\}/,O=/#|\^|\/|>|\{|&|=|!/;function I(e){this.string=e,this.tail=e,this.pos=0}function a(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function e(){this.cache={}}I.prototype.eos=function(){return""===this.tail},I.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},I.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},a.prototype.push=function(e){return new a(e,this)},a.prototype.lookup=function(e){var t,n=this.cache;if(n.hasOwnProperty(e))t=n[e];else{for(var r,i,a=this,o=!1;a;){if(0<e.indexOf("."))for(t=a.view,r=e.split("."),i=0;null!=t&&i<r.length;)i===r.length-1&&(o=s(t,r[i])),t=t[r[i++]];else t=a.view[e],o=s(a.view,e);if(o)break;a=a.parent}n[e]=t}return c(t)&&(t=t.call(this.view)),t},e.prototype.clearCache=function(){this.cache={}},e.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e+":"+(t||E.tags).join(":")]=function(e,t){if(!e)return[];var n,r,i,a=[],o=[],s=[],l=!1,c=!1;function u(){if(l&&!c)for(;s.length;)delete o[s.pop()];else s=[];c=l=!1}function d(e){if("string"==typeof e&&(e=e.split(C,2)),!k(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(T(e[0])+"\\s*"),r=new RegExp("\\s*"+T(e[1])),i=new RegExp("\\s*"+T("}"+e[1]))}d(t||E.tags);for(var h,p,f,m,v,g,y=new I(e);!y.eos();){if(h=y.pos,f=y.scanUntil(n))for(var w=0,b=f.length;w<b;++w)x(m=f.charAt(w))?s.push(o.length):c=!0,o.push(["text",m,h,h+1]),h+=1,"\n"===m&&u();if(!y.scan(n))break;if(l=!0,p=y.scan(O)||"name",y.scan(L),"="===p?(f=y.scanUntil(A),y.scan(A),y.scanUntil(r)):"{"===p?(f=y.scanUntil(i),y.scan(j),y.scanUntil(r),p="&"):f=y.scanUntil(r),!y.scan(r))throw new Error("Unclosed tag at "+y.pos);if(v=[p,f,h,y.pos],o.push(v),"#"===p||"^"===p)a.push(v);else if("/"===p){if(!(g=a.pop()))throw new Error('Unopened section "'+f+'" at '+h);if(g[1]!==f)throw new Error('Unclosed section "'+g[1]+'" at '+h)}else"name"===p||"{"===p||"&"===p?c=!0:"="===p&&d(f)}if(g=a.pop())throw new Error('Unclosed section "'+g[1]+'" at '+y.pos);return function(e){for(var t,n=[],r=n,i=[],a=0,o=e.length;a<o;++a)switch((t=e[a])[0]){case"#":case"^":r.push(t),i.push(t),r=t[4]=[];break;case"/":i.pop()[5]=t[2],r=0<i.length?i[i.length-1][4]:n;break;default:r.push(t)}return n}(function(e){for(var t,n,r=[],i=0,a=e.length;i<a;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}(o))}(e,t)),r},e.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof a?t:new a(t);return this.renderTokens(r,i,n,e)},e.prototype.renderTokens=function(e,t,n,r){for(var i,a,o,s="",l=0,c=e.length;l<c;++l)o=void 0,"#"===(a=(i=e[l])[0])?o=this.renderSection(i,t,n,r):"^"===a?o=this.renderInverted(i,t,n,r):">"===a?o=this.renderPartial(i,t,n,r):"&"===a?o=this.unescapedValue(i,t):"name"===a?o=this.escapedValue(i,t):"text"===a&&(o=this.rawValue(i)),void 0!==o&&(s+=o);return s},e.prototype.renderSection=function(e,t,n,r){var i=this,a="",o=t.lookup(e[1]);if(o){if(k(o))for(var s=0,l=o.length;s<l;++s)a+=this.renderTokens(e[4],t.push(o[s]),n,r);else if("object"==typeof o||"string"==typeof o||"number"==typeof o)a+=this.renderTokens(e[4],t.push(o),n,r);else if(c(o)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(o=o.call(t.view,r.slice(e[3],e[5]),function(e){return i.render(e,t,n)}))&&(a+=o)}else a+=this.renderTokens(e[4],t,n,r);return a}},e.prototype.renderInverted=function(e,t,n,r){var i=t.lookup(e[1]);if(!i||k(i)&&0===i.length)return this.renderTokens(e[4],t,n,r)},e.prototype.renderPartial=function(e,t,n){if(n){var r=c(n)?n(e[1]):n[e[1]];return null!=r?this.renderTokens(this.parse(r),t,n,r):void 0}},e.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},e.prototype.escapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return E.escape(n)},e.prototype.rawValue=function(e){return e[1]},E.name="mustache.js",E.version="2.3.0",E.tags=["{{","}}"];var o=new e;return E.clearCache=function(){return o.clearCache()},E.parse=function(e,t){return o.parse(e,t)},E.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(k(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)');var r;return o.render(e,t,n)},E.to_html=function(e,t,n,r){var i=E.render(e,t,n);if(!c(r))return i;r(i)},E.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return n[e]})},E.Scanner=I,E.Context=a,E.Writer=e,E}),function(t){var n=[],r=-1,i=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||t.oRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)};!function e(){if(r==t.pageYOffset)return i(e),!1;r=t.pageYOffset,n.forEach(function(e){"function"==typeof e&&e(r)}),i(e)}(),t.SCROLL_LOOP=n}(this),function(u){var e=function(e){this.activeFrame=0,this.headlineTrack=document.getElementById("headline-track"),this.headlines=[],this.framesWrap=document.getElementById("frames"),this.frames=e,this.canvas=document.getElementById("canvas"),this.frameEls=[],this.next=document.getElementById("next"),this.previous=document.getElementById("previous"),this.introText=document.getElementById("js-intro-text"),this.init()};e.prototype.init=function(){this.buildContent(),this.addEventListeners(),this.animateIntroText(),this.monitorFrames(),document.body.classList.add("initialized")},e.prototype.animateIntroText=function(){},e.prototype.buildContent=function(){var o=this,s={project:document.getElementById("template-project").innerHTML,intro:document.getElementById("template-intro").innerHTML,outro:document.getElementById("template-outro").innerHTML};this.frames.forEach(function(e,t){var n=document.createElement("div");n.className="headline-item animate "+(0===t?"active":""),n.innerHTML='<div class="headline-text">'+e.headline+"</div>",o.headlineTrack.appendChild(n),o.headlines.push(n);var r=Object.assign(e,{i:t}),i=e.template?s[e.template]:s.project,a=Mustache.render(i,r);o.framesWrap.innerHTML+=a}),this.frameEls=document.querySelectorAll(".frame")},e.prototype.addEventListeners=function(){var i=this;document.addEventListener("keydown",function(e){var t;if(40===e.keyCode||38===e.keyCode){switch(e.preventDefault(),e.keyCode){case 40:t=i.activeFrame+1;break;case 38:t=i.activeFrame-1}var n=i.frames[t].id,r=document.getElementById(n);u.scrollTo(0,r.offsetTop)}})},e.prototype.monitorFrames=function(){var c=this;this.frameEls.forEach(function(r,i){var a=c.frames[i],o=a.color?a.color:"#222",s=a.fill?a.fill:"#e8e8e8",l=document.getElementById("video-"+i);function e(e){var t=r.offsetTop-u.innerHeight/2,n=r.offsetHeight+r.offsetTop-u.innerHeight/2;t<=e&&e<n?r.classList.contains("active")||(r.classList.add("active"),c.activeFrame=i,c.canvas.style.backgroundColor=s,c.updateMask(a,i),document.body.style.color=o,l&&l.play()):(r.classList.remove("active"),l&&l.pause())}e(u.pageYOffset),SCROLL_LOOP.push(e)})},e.prototype.updateMask=function(e,n){var t=this,r=t.next,i=t.previous;switch(t.headlines.forEach(function(e,t){t===n?e.classList.add("active"):e.classList.remove("active")}),t.headlineTrack.style.transform="translate3d(0,"+-10*n+"vw,0)",t.headlineTrack.style.webkitTransform="translate3d(0,"+-10*n+"vw,0)",t.headlineTrack.style.mozTransform="translate3d(0,"+-10*n+"vw,0)",t.headlineTrack.style.msTransform="translate3d(0,"+-10*n+"vw,0)",t.headlineTrack.style.oTransform="translate3d(0,"+-10*n+"vw,0)",n){case 0:i.classList.remove("active"),r.classList.add("active"),r.setAttribute("href","#"+t.frames[n+1].id);break;case t.frames.length-1:i.classList.add("active"),i.setAttribute("href","#"+t.frames[n-1].id),r.classList.remove("active");break;default:i.classList.add("active"),i.setAttribute("href","#"+t.frames[n-1].id),r.classList.add("active"),r.setAttribute("href","#"+t.frames[n+1].id)}},document_ready(new e(APP_FRAMES))}(this);